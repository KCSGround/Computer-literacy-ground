# Section11 피벗 테이블

피벗(Pivot)이란 `'요점, 중심축, 주축을 중심으로 회전하다'` 라는 의미로, 작성된 데이터 목록의 필드를 재구성하여 전체 데이터에 대한 통계를 한눈에 파악할 수 있도록 정리된 표로 만드는 기능이다. 피벗 테이블은 정렬, 부분합, 자동 필터 등 엑셀에서 수행할 수 있는 다양한 기능을 실행할 수 있으므로 사용자의 요구에 맞는 통계 자료를 쉽게 만들 수 있다.

---

## 무작정따라하기 섹션11문제.xlsm 파일

<br>

- 외부 데이터 가져오기 기능을 이용하요 <가품가공.accdb>의 <팀별가공현황> 테이블에서 '제조순번', '가공일', '가공팀', '단위당원가', '목표매출액' 열을 이용하시오.

- 피벗 테이블 보고서의 레이아웃과 위치는 <그림> 을 참조하여 설정하고, 보고서 레이아웃을 개요 형식으로 표시하시오.

- '가공일' 필드는 '월'단위로 그룹을 지정하시오.

- 완성된 피벗 테이블 보고서에는 '피벗 스타일 보통 6'을 지정하시오.

- '가공팀' 필드는 '제조1팀', '제조3팀', '제조5팀'만 나타나도록 한 후 '단위당원가'와 '목표매출액' 필드를 열 합계 비율ㅇ르 기준으로 그림과 같이 나타나도록 작성하시오.

- 값 영역의 표시 형식은 '값 필드 설정' 의 셀 서식을 이용하여 소수 1자리까지 표시하시오. '제조3팀'의 3월 목표매출액 데이터만 자동 생성한 후 시트 이름을 '3월가공현황'으로 지정하시오.

<br>

> 매화 빠짐 없이 출제되고 있는 부분이다. 문자 그룹 지정, 값 표시 형식 지정 등 2급에서 다루지 않았던 자세한 기능까지 모두 알고 있어야 한다.

---

1. 분석할 데이터 위치 지정

   [데이터] -> 외부 데이터 가져오기 -> 기타 원본에서 데이터 가져오기 -> Microsoft Query를 차례로 선택

   '데이터 원본 선택' 대화상자에서 가져올 파일이 엑세스 파일이므로 '데이터 원본 선택' 대화상자의 '데이터베이스' 탭에서 'MS Access Datbase\*' 를 선택한 후 확인을 누르고 파일을 선택한다.

   '쿼리 마법사 - 열 선택' 대화상자가 나타나는데 '사용할 수 있는 테이블과 열' 에서 <팀별가공현황> 테이블을 누른다.

   <팀별가공현황> 테이블의 '제조순번' 열을 더블클릭하고 '제조순번' 열이 '쿼리에 포함된 열' 로 이동한다. 나머지 열도 같은 방법으로 옮긴다.

   `데이터 필터`는 행을 필터하기 위한 단계이다. 해당 단계는 현재 필요하지 않으므로 다음을 누른다.

   `정렬 순서` 는 정렬 기준과 정렬 방식을 지정하는 단계이다. 정렬 사항이 없으므로 다음을 누른다.

   `마침` 에서는 Excel로 데이터 되돌리기를 선택한 후 마침을 누른다.

   `데이터 가져오기` 대화상자가 나타나면 표시할 방법을 `피벗 테이블 보고서` 로, 작성 위치를 `기준 워크시트 A3` 셀을 지정한 후 확인을 누른다.

<br>

2. 레이아웃 설정

   데이터가 표시되어 있지 않은 피벗 테이블과 `피벗 테이블 필드` 창이 나타난다. `피벗 테이블 필드` 창에서 필터 영역에 '제조순번', 행 영역에 '가공팀', '가공일', 값 영역에 '단위당원가', '목표매출액'을 끌어다 놓는다. 행이나 열 영역에 날짜 형식의 필드를 넣으면 '연', '분기', '월' 등의 필드가 자동으로 생성되고, 값 영역에 두 개 이상의 필드를 넣으면 열 영역에 자동으로 시그마 값이 생성된다.

   작성된 피벗 테이블의 임의의 셀을 클릭한 후 [피벗 테이블 도구] -> 디자인 -> 레이아웃 -> 보고서 레이아웃 -> `개요 형식으로 표시` 를 선택한다.

<br>

3. 피벗 테이블 필드 함수 지정

   값 영역에 놓인 필드는 기본적으로 합계가 계산되는데 이것을 평균으로 변경해야 한다. <단위당원가> 필드가 표시된 임의의 셀의 바로가기 메뉴에서 `[값 필드 설정]` 을 선택한다.

<br>

4. 값 필드의 표시 형식 지정하기

   '값 필드 설정' 대화상자의 '값 표시 형식' 탭을 클릭하고 '값 표시 형식' 항목에서 '열 합계 비율'을 선택한다.

<br>

5. 피벗 테이블 필드 표시 형식 설정

   '값 필드 설정' 대화상자의 <표시 형식> 단추를 클릭하고 '셀 서식' 대화상자에서 백분율의 소수 자릿수를 1로 지정한 후 <확인>을 클릭한다. 다시 '값 필드 설정' 대화상자가 표시되면 여기서도 <확인> 을 클릭한다.

   같은 방법으로 <목표매출액> 필드에 대해서도 함수는 '평균', '값 표시 형식'은 '열 합계 비율', 표시 형식은 백분율의 소수 자릿수를 1로 지정한 후 <확인> 을 클릭한다.

<br>

6. 그룹 지정

   <가공일> 필드에 대해 월 단위의 그룹을 지정하기 위해 <가공일> 필드의 바로가기 메뉴에서 [그룹] 을 선택하고 '그룹화' 대화상자에서 '일'의 선택을 해제하여 '월'만 지정된 상태에서 <확인>을 클릭한다.

<br>

7. 피벗 테이블 스타일

   '피벗 스타일 보통 6'을 지정하기 위해 피벗 테이블에서 임의의 셀을 선택한 후 [피벗 테이블 도구] -> 디자인 -> 피벗 테이블 스타일의 (자세히 아래쪽 화살표)를 클릭하여 '피벗 스타일 보통 6' 을 지정한다.

<br>

8. 필드의 특정 목록만 표시

   문제에 제시된'제조1팀', '제조3팀', '제조5팀' 만 표시하기 위해 <가공팀> 필드의 목록 단추를 클릭하고 '제조2팀', '제조4팀', '제조6팀'의 체크 표시를 해제한 후 <확인>을 클릭. 피벗 테이블 보고서가 완성된다.

<br>

9. 특정 데이터만 별도 시트에 표시

   제조3팀의 3월 목표매출액'만 다른 시트에 생성하기 위해 [D9] 셀을 더블 클릭한다. 현재 시트 앞에 'Sheet1' 시트가 생성되며 '제조3팀의 3월 목표매출액'만 표시하면 된다. 'Sheet1' 부분을 더블클릭한 후 이름을 3월가공현황으로 변경하라.
